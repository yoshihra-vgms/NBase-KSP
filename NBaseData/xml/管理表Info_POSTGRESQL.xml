<?xml version="1.0" encoding="utf-8" ?>

<databaseConfig>

  <sql name="GetRecordsForランニング管理表">
    SELECT
    thi.MS_VESSEL_ID,
    thi.NAIYOU,
    thi.BIKOU,
    usr.SEI || ' ' || usr.MEI as JIM_TANTOU_NAME,
    mk.HACHU_NO,
    mk.HACHU_DATE,
    mk.AMOUNT,
    mk.MK_AMOUNT,
    cst.CUSTOMER_NAME as MS_CUSTOMER_NAME,
    jry.STATUS as J_STATUS,
    jry.JRY_DATE,
    jry.AMOUNT as J_AMOUNT,
    jry.NEBIKI_AMOUNT as J_N_AMOUNT,
    rks.STATUS as R_STATUS,
    rks.AMOUNT as R_AMOUNT,
    rks.NEBIKI_AMOUNT as R_N_AMOUNT,
    shr.STATUS as S_STATUS,
    shr.AMOUNT as S_AMOUNT,
    shr.NEBIKI_AMOUNT as S_N_AMOUNT,
    shr.SHR_DATE as S_SHR_DATE,
    shr.KIHYOUBI,
    shr.KEIJO_DATE
    FROM
    OD_THI thi
    INNER JOIN MS_USER usr ON usr.MS_USER_ID = thi.JIM_TANTOU_ID
    INNER JOIN OD_MM mm ON mm.OD_THI_ID = thi.OD_THI_ID AND mm.CANCEL_FLAG = 0
    INNER JOIN OD_MK mk ON mk.OD_MM_ID = mm.OD_MM_ID AND mk.CANCEL_FLAG = 0 AND mk.STATUS = :MK_STATUS
    AND TO_CHAR(mk.HACHU_DATE,'YYYY/MM/DD') >= :HACHU_DATE_FROM
    AND TO_CHAR(mk.HACHU_DATE,'YYYY/MM/DD') &lt;= :HACHU_DATE_TO
    INNER JOIN MS_CUSTOMER cst ON mk.MS_CUSTOMER_ID = cst.MS_CUSTOMER_ID
    INNER JOIN OD_JRY jry ON jry.OD_MK_ID = mk.OD_MK_ID AND jry.CANCEL_FLAG = 0
    LEFT OUTER JOIN OD_SHR rks ON rks.OD_JRY_ID = jry.OD_JRY_ID AND rks.CANCEL_FLAG = 0 AND rks.SBT = :SHR_SBT_RKS
    LEFT OUTER JOIN OD_SHR shr ON shr.OD_JRY_ID = jry.OD_JRY_ID AND shr.CANCEL_FLAG = 0 AND shr.SBT = :SHR_SBT_SHR
    AND (shr.STATUS != :SHR_STATUS_IRAIZUMI OR (shr.STATUS = :SHR_STATUS_SUMI AND (shr.SYORI_STATUS = :SYORI_STATUS_JISSEKI OR shr.SYORI_STATUS = :SYORI_STATUS_SUMI)))
    WHERE
    thi.CANCEL_FLAG = 0 AND
    thi.MS_THI_IRAI_SBT_ID = :MS_THI_IRAI_SBT_ID AND
    thi.MS_THI_IRAI_SHOUSAI_ID = :MS_THI_IRAI_SHOUSAI_ID

    ORDER BY thi.MS_VESSEL_ID, shr.KEIJO_DATE, mk.HACHU_DATE, mk.HACHU_NO
  </sql>

  
  <sql name="GetRecordsFor入渠管理表">
    SELECT
    thi.MS_VESSEL_ID,
    thi.NAIYOU,
    thi.BIKOU,
    usr.SEI || ' ' || usr.MEI as JIM_TANTOU_NAME,
    mm.MS_NYUKYO_KAMOKU_ID,
    mk.HACHU_DATE,
    mk.HACHU_NO,
    mk.AMOUNT,
    mk.MK_AMOUNT,
    cst.CUSTOMER_NAME as MS_CUSTOMER_NAME,
    jry.STATUS as J_STATUS,
    jry.JRY_DATE,
    jry.AMOUNT as J_AMOUNT,
    jry.NEBIKI_AMOUNT as J_NEBIKI_AMOUNT,
    rks.STATUS as R_STATUS,
    rks.SHR_DATE as R_SHR_DATE,
    rks.AMOUNT as R_AMOUNT,
    rks.NEBIKI_AMOUNT as R_NEBIKI_AMOUNT,
    shr.STATUS as S_STATUS,
    shr.AMOUNT as S_AMOUNT,
    shr.NEBIKI_AMOUNT as NEBIKI_AMOUNT,
    shr.KIHYOUBI,
    shr.KEIJO_DATE,
    shr.SHR_DATE as S_SHR_DATE
    FROM
    OD_THI thi
    INNER JOIN MS_USER usr ON usr.MS_USER_ID = thi.JIM_TANTOU_ID
    INNER JOIN OD_MM mm ON mm.OD_THI_ID = thi.OD_THI_ID AND mm.CANCEL_FLAG = 0
    INNER JOIN OD_MK mk ON mk.OD_MM_ID = mm.OD_MM_ID AND mk.CANCEL_FLAG = 0 AND mk.STATUS = :MK_STATUS
    AND TO_CHAR(mk.HACHU_DATE,'YYYY/MM/DD') >= :HACHU_DATE_FROM
    AND TO_CHAR(mk.HACHU_DATE,'YYYY/MM/DD') &lt;= :HACHU_DATE_TO
    INNER JOIN MS_CUSTOMER cst ON mk.MS_CUSTOMER_ID = cst.MS_CUSTOMER_ID
    INNER JOIN OD_JRY jry ON jry.OD_MK_ID = mk.OD_MK_ID AND jry.CANCEL_FLAG = 0
    LEFT OUTER JOIN OD_SHR rks ON rks.OD_JRY_ID = jry.OD_JRY_ID AND rks.CANCEL_FLAG = 0 AND rks.SBT = :SHR_SBT_RKS
    LEFT OUTER JOIN OD_SHR shr ON shr.OD_JRY_ID = jry.OD_JRY_ID AND shr.CANCEL_FLAG = 0 AND shr.SBT = :SHR_SBT_SHR
    AND (shr.STATUS != :SHR_STATUS_IRAIZUMI OR (shr.STATUS = :SHR_STATUS_SUMI AND (shr.SYORI_STATUS = :SYORI_STATUS_JISSEKI OR shr.SYORI_STATUS = :SYORI_STATUS_SUMI)))
    WHERE
    thi.CANCEL_FLAG = 0 AND
    thi.MS_THI_IRAI_SBT_ID = :MS_THI_IRAI_SBT_ID AND
    thi.MS_THI_IRAI_SHOUSAI_ID != :MS_THI_IRAI_SHOUSAI_ID

    ORDER BY thi.MS_VESSEL_ID, TO_NUMBER(mm.MS_NYUKYO_KAMOKU_ID,'9999999999'), mk.HACHU_DATE, mk.HACHU_NO
  </sql>



  <sql name="GetRecordsFor船用品管理表">
    SELECT
    thi.MS_VESSEL_ID,
    thi.THI_IRAI_DATE,
    thi.NAIYOU,
    thi.BIKOU,
    mk.HACHU_NO,
    mk.HACHU_DATE,
    mk.AMOUNT,
    mk.MK_AMOUNT,
    cst.CUSTOMER_NAME as MS_CUSTOMER_NAME,
    jry.STATUS as J_STATUS,
    jry.JRY_DATE,
    jry.AMOUNT as J_AMOUNT,
    jry.NEBIKI_AMOUNT as J_N_AMOUNT,
    shr.STATUS as S_STATUS,
    shr.AMOUNT as S_AMOUNT,
    shr.NEBIKI_AMOUNT as S_N_AMOUNT,
    shr.SHR_IRAI_DATE,
    shr.SHR_DATE as S_SHR_DATE,
    shr.KIHYOUBI,
    shr.KEIJO_DATE
    FROM
    OD_THI thi
    INNER JOIN OD_MM mm ON mm.OD_THI_ID = thi.OD_THI_ID AND mm.CANCEL_FLAG = 0
    INNER JOIN OD_MK mk ON mk.OD_MM_ID = mm.OD_MM_ID AND mk.CANCEL_FLAG = 0 AND mk.STATUS = :MK_STATUS
    AND TO_CHAR(mk.HACHU_DATE,'YYYY/MM/DD') >= :HACHU_DATE_FROM
    AND TO_CHAR(mk.HACHU_DATE,'YYYY/MM/DD') &lt;= :HACHU_DATE_TO
    INNER JOIN MS_CUSTOMER cst ON mk.MS_CUSTOMER_ID = cst.MS_CUSTOMER_ID
    INNER JOIN OD_JRY jry ON jry.OD_MK_ID = mk.OD_MK_ID AND jry.CANCEL_FLAG = 0
    LEFT OUTER JOIN OD_SHR shr ON shr.OD_JRY_ID = jry.OD_JRY_ID AND shr.CANCEL_FLAG = 0 AND shr.SBT = :SHR_SBT_SHR
    AND (shr.STATUS != :SHR_STATUS_IRAIZUMI OR (shr.STATUS = :SHR_STATUS_SUMI AND (shr.SYORI_STATUS = :SYORI_STATUS_JISSEKI OR shr.SYORI_STATUS = :SYORI_STATUS_SUMI)))
    WHERE
    thi.CANCEL_FLAG =0 AND
    thi.MS_THI_IRAI_SBT_ID = :MS_THI_IRAI_SBT_ID

    ORDER BY thi.MS_VESSEL_ID, shr.KEIJO_DATE, mk.HACHU_DATE, mk.HACHU_NO
  </sql>


</databaseConfig>

<?xml version="1.0" encoding="utf-8" ?>

<databaseConfig>

	<sql name="GetRecords">
    SELECT
    BG_YOSAN_ITEM.YOSAN_ITEM_ID,
    BG_YOSAN_ITEM.VESSEL_YOSAN_ID,
    BG_YOSAN_ITEM.NENGETSU,
    BG_YOSAN_ITEM.MS_HIMOKU_ID,
    BG_YOSAN_ITEM.YEN_AMOUNT,
    BG_YOSAN_ITEM.DOLLER_AMOUNT,
    BG_YOSAN_ITEM.AMOUNT,
    BG_YOSAN_ITEM.PRE_YEN_AMOUNT,
    BG_YOSAN_ITEM.PRE_DOLLER_AMOUNT,
    BG_YOSAN_ITEM.PRE_AMOUNT,
    BG_YOSAN_ITEM.BIKOU,
    BG_YOSAN_ITEM.RENEW_DATE,
    BG_YOSAN_ITEM.RENEW_USER_ID,
    BG_YOSAN_ITEM.TS

    FROM BG_YOSAN_ITEM

    WHERE 1 = 1
  </sql>

	<sql name="GetRecord">
    SELECT
    BG_YOSAN_ITEM.YOSAN_ITEM_ID,
    BG_YOSAN_ITEM.VESSEL_YOSAN_ID,
    BG_YOSAN_ITEM.NENGETSU,
    BG_YOSAN_ITEM.MS_HIMOKU_ID,
    BG_YOSAN_ITEM.YEN_AMOUNT,
    BG_YOSAN_ITEM.DOLLER_AMOUNT,
    BG_YOSAN_ITEM.AMOUNT,
    BG_YOSAN_ITEM.PRE_YEN_AMOUNT,
    BG_YOSAN_ITEM.PRE_DOLLER_AMOUNT,
    BG_YOSAN_ITEM.PRE_AMOUNT,
    BG_YOSAN_ITEM.BIKOU,
    BG_YOSAN_ITEM.RENEW_DATE,
    BG_YOSAN_ITEM.RENEW_USER_ID,
    BG_YOSAN_ITEM.TS
    FROM BG_YOSAN_ITEM
    WHERE
    BG_YOSAN_ITEM.YOSAN_ITEM_ID = :YOSAN_ITEM_ID
  </sql>

  <sql name="GetRecords_年単位_船">
    SELECT
    BG_YOSAN_ITEM.YOSAN_ITEM_ID,
    BG_YOSAN_ITEM.VESSEL_YOSAN_ID,
    BG_YOSAN_ITEM.NENGETSU,
    BG_YOSAN_ITEM.MS_HIMOKU_ID,
    BG_YOSAN_ITEM.YEN_AMOUNT,
    BG_YOSAN_ITEM.DOLLER_AMOUNT,
    BG_YOSAN_ITEM.AMOUNT,
    BG_YOSAN_ITEM.PRE_YEN_AMOUNT,
    BG_YOSAN_ITEM.PRE_DOLLER_AMOUNT,
    BG_YOSAN_ITEM.PRE_AMOUNT,
    BG_YOSAN_ITEM.BIKOU,
    BG_YOSAN_ITEM.RENEW_DATE,
    BG_YOSAN_ITEM.RENEW_USER_ID,
    BG_YOSAN_ITEM.TS

    FROM
    BG_YOSAN_ITEM

    INNER JOIN
    BG_VESSEL_YOSAN ON BG_VESSEL_YOSAN.VESSEL_YOSAN_ID = BG_YOSAN_ITEM.VESSEL_YOSAN_ID

    INNER JOIN
    BG_YOSAN_HEAD ON BG_YOSAN_HEAD.YOSAN_HEAD_ID = BG_VESSEL_YOSAN.YOSAN_HEAD_ID

    WHERE
    BG_YOSAN_HEAD.YOSAN_HEAD_ID = :YOSAN_HEAD_ID
    AND
    BG_VESSEL_YOSAN.MS_VESSEL_ID = :MS_VESSEL_ID
    AND
    BG_VESSEL_YOSAN.YEAR >= :YEAR_START
    AND
    BG_VESSEL_YOSAN.YEAR &lt;= :YEAR_END
    AND
    LENGTH(TRIM(BG_YOSAN_ITEM.NENGETSU)) = 4

    ORDER BY
    BG_YOSAN_ITEM.MS_HIMOKU_ID,
    BG_YOSAN_ITEM.VESSEL_YOSAN_ID
  </sql>

  <sql name="GetRecords_年単位_全社">
    SELECT
    BG_YOSAN_ITEM.NENGETSU,
    BG_YOSAN_ITEM.MS_HIMOKU_ID,
    SUM(BG_YOSAN_ITEM.YEN_AMOUNT) AS YEN_AMOUNT,
    SUM(BG_YOSAN_ITEM.DOLLER_AMOUNT) AS DOLLER_AMOUNT,
    SUM(BG_YOSAN_ITEM.AMOUNT) AS AMOUNT,
    SUM(BG_YOSAN_ITEM.PRE_YEN_AMOUNT) AS PRE_YEN_AMOUNT,
    SUM(BG_YOSAN_ITEM.PRE_DOLLER_AMOUNT) AS PRE_DOLLER_AMOUNT,
    SUM(BG_YOSAN_ITEM.PRE_AMOUNT) AS PRE_AMOUNT

    FROM
    BG_YOSAN_ITEM

    INNER JOIN
    BG_VESSEL_YOSAN ON BG_VESSEL_YOSAN.VESSEL_YOSAN_ID = BG_YOSAN_ITEM.VESSEL_YOSAN_ID

    INNER JOIN
    BG_YOSAN_HEAD ON BG_YOSAN_HEAD.YOSAN_HEAD_ID = BG_VESSEL_YOSAN.YOSAN_HEAD_ID

    WHERE
    BG_YOSAN_HEAD.YOSAN_HEAD_ID = :YOSAN_HEAD_ID
    AND
    BG_VESSEL_YOSAN.YEAR >= :YEAR_START
    AND
    BG_VESSEL_YOSAN.YEAR &lt;= :YEAR_END
    AND
    LENGTH(TRIM(BG_YOSAN_ITEM.NENGETSU)) = 4

    GROUP BY
    BG_YOSAN_ITEM.NENGETSU,
    BG_YOSAN_ITEM.MS_HIMOKU_ID

    ORDER BY
    BG_YOSAN_ITEM.NENGETSU,
    BG_YOSAN_ITEM.MS_HIMOKU_ID
  </sql>

  <sql name="GetRecords_年単位_グループ">
    SELECT
    BG_YOSAN_ITEM.NENGETSU,
    BG_YOSAN_ITEM.MS_HIMOKU_ID,
    SUM(BG_YOSAN_ITEM.YEN_AMOUNT) AS YEN_AMOUNT,
    SUM(BG_YOSAN_ITEM.DOLLER_AMOUNT) AS DOLLER_AMOUNT,
    SUM(BG_YOSAN_ITEM.AMOUNT) AS AMOUNT,
    SUM(BG_YOSAN_ITEM.PRE_YEN_AMOUNT) AS PRE_YEN_AMOUNT,
    SUM(BG_YOSAN_ITEM.PRE_DOLLER_AMOUNT) AS PRE_DOLLER_AMOUNT,
    SUM(BG_YOSAN_ITEM.PRE_AMOUNT) AS PRE_AMOUNT

    FROM
    BG_YOSAN_ITEM

    INNER JOIN
    BG_VESSEL_YOSAN ON BG_VESSEL_YOSAN.VESSEL_YOSAN_ID = BG_YOSAN_ITEM.VESSEL_YOSAN_ID

    INNER JOIN
    BG_YOSAN_HEAD ON BG_YOSAN_HEAD.YOSAN_HEAD_ID = BG_VESSEL_YOSAN.YOSAN_HEAD_ID

    INNER JOIN
    MS_VESSEL ON MS_VESSEL.MS_VESSEL_ID = BG_VESSEL_YOSAN.MS_VESSEL_ID

    INNER JOIN
    MS_VESSEL_TYPE ON MS_VESSEL_TYPE.MS_VESSEL_TYPE_ID = MS_VESSEL.MS_VESSEL_TYPE_ID

    WHERE
    BG_YOSAN_HEAD.YOSAN_HEAD_ID = :YOSAN_HEAD_ID
    AND
    MS_VESSEL_TYPE.MS_VESSEL_TYPE_ID = :MS_VESSEL_TYPE_ID
    AND
    BG_VESSEL_YOSAN.YEAR >= :YEAR_START
    AND
    BG_VESSEL_YOSAN.YEAR &lt;= :YEAR_END
    AND
    LENGTH(TRIM(BG_YOSAN_ITEM.NENGETSU)) = 4

    GROUP BY
    BG_YOSAN_ITEM.NENGETSU,
    BG_YOSAN_ITEM.MS_HIMOKU_ID

    ORDER BY
    BG_YOSAN_ITEM.NENGETSU,
    BG_YOSAN_ITEM.MS_HIMOKU_ID
  </sql>

  <sql name="GetRecords_月単位">
    SELECT
    BG_YOSAN_ITEM.YOSAN_ITEM_ID,
    BG_YOSAN_ITEM.VESSEL_YOSAN_ID,
    BG_YOSAN_ITEM.NENGETSU,
    BG_YOSAN_ITEM.MS_HIMOKU_ID,
    BG_YOSAN_ITEM.YEN_AMOUNT,
    BG_YOSAN_ITEM.DOLLER_AMOUNT,
    BG_YOSAN_ITEM.AMOUNT,
    BG_YOSAN_ITEM.PRE_YEN_AMOUNT,
    BG_YOSAN_ITEM.PRE_DOLLER_AMOUNT,
    BG_YOSAN_ITEM.PRE_AMOUNT,
    BG_YOSAN_ITEM.BIKOU,
    BG_YOSAN_ITEM.RENEW_DATE,
    BG_YOSAN_ITEM.RENEW_USER_ID,
    BG_YOSAN_ITEM.TS

    FROM
    BG_YOSAN_ITEM

    INNER JOIN
    BG_VESSEL_YOSAN ON BG_VESSEL_YOSAN.VESSEL_YOSAN_ID = BG_YOSAN_ITEM.VESSEL_YOSAN_ID

    INNER JOIN
    BG_YOSAN_HEAD ON BG_YOSAN_HEAD.YOSAN_HEAD_ID = BG_VESSEL_YOSAN.YOSAN_HEAD_ID

    WHERE
    BG_YOSAN_HEAD.YOSAN_HEAD_ID = :YOSAN_HEAD_ID
    AND
    BG_VESSEL_YOSAN.MS_VESSEL_ID = :MS_VESSEL_ID
    AND
    BG_VESSEL_YOSAN.YEAR >= :YEAR_START
    AND
    BG_VESSEL_YOSAN.YEAR &lt;= :YEAR_END
    AND
    LENGTH(TRIM(BG_YOSAN_ITEM.NENGETSU)) = 6

    ORDER BY
    BG_YOSAN_ITEM.MS_HIMOKU_ID,
    BG_YOSAN_ITEM.VESSEL_YOSAN_ID,
    BG_YOSAN_ITEM.NENGETSU
  </sql>

	<sql name="GetRecords_月単位_グループ">
    SELECT
    BG_YOSAN_ITEM.NENGETSU,
    BG_YOSAN_ITEM.MS_HIMOKU_ID,
    SUM(BG_YOSAN_ITEM.YEN_AMOUNT) AS YEN_AMOUNT,
    SUM(BG_YOSAN_ITEM.DOLLER_AMOUNT) AS DOLLER_AMOUNT,
    SUM(BG_YOSAN_ITEM.AMOUNT) AS AMOUNT,
    SUM(BG_YOSAN_ITEM.PRE_YEN_AMOUNT) AS PRE_YEN_AMOUNT,
    SUM(BG_YOSAN_ITEM.PRE_DOLLER_AMOUNT) AS PRE_DOLLER_AMOUNT,
    SUM(BG_YOSAN_ITEM.PRE_AMOUNT) AS PRE_AMOUNT

    FROM
    BG_YOSAN_ITEM

    INNER JOIN
    BG_VESSEL_YOSAN ON BG_VESSEL_YOSAN.VESSEL_YOSAN_ID = BG_YOSAN_ITEM.VESSEL_YOSAN_ID

    INNER JOIN
    BG_YOSAN_HEAD ON BG_YOSAN_HEAD.YOSAN_HEAD_ID = BG_VESSEL_YOSAN.YOSAN_HEAD_ID

    INNER JOIN
    MS_VESSEL ON MS_VESSEL.MS_VESSEL_ID = BG_VESSEL_YOSAN.MS_VESSEL_ID

    INNER JOIN
    MS_VESSEL_TYPE ON MS_VESSEL_TYPE.MS_VESSEL_TYPE_ID = MS_VESSEL.MS_VESSEL_TYPE_ID

    WHERE
    BG_YOSAN_HEAD.YOSAN_HEAD_ID = :YOSAN_HEAD_ID
    AND
    MS_VESSEL_TYPE.MS_VESSEL_TYPE_ID = :MS_VESSEL_TYPE_ID
    AND
    BG_VESSEL_YOSAN.YEAR >= :YEAR_START
    AND
    BG_VESSEL_YOSAN.YEAR &lt;= :YEAR_END
		AND
		LENGTH(TRIM(BG_YOSAN_ITEM.NENGETSU)) = 6

		GROUP BY
		BG_YOSAN_ITEM.NENGETSU,
		BG_YOSAN_ITEM.MS_HIMOKU_ID

		ORDER BY
		BG_YOSAN_ITEM.NENGETSU,
		BG_YOSAN_ITEM.MS_HIMOKU_ID
	</sql>

	<sql name="GetRecords_月単位_全社">
    SELECT
    BG_YOSAN_ITEM.NENGETSU,
    BG_YOSAN_ITEM.MS_HIMOKU_ID,
    SUM(BG_YOSAN_ITEM.YEN_AMOUNT) AS YEN_AMOUNT,
    SUM(BG_YOSAN_ITEM.DOLLER_AMOUNT) AS DOLLER_AMOUNT,
    SUM(BG_YOSAN_ITEM.AMOUNT) AS AMOUNT,
    SUM(BG_YOSAN_ITEM.PRE_YEN_AMOUNT) AS PRE_YEN_AMOUNT,
    SUM(BG_YOSAN_ITEM.PRE_DOLLER_AMOUNT) AS PRE_DOLLER_AMOUNT,
    SUM(BG_YOSAN_ITEM.PRE_AMOUNT) AS PRE_AMOUNT

    FROM
    BG_YOSAN_ITEM

    INNER JOIN
    BG_VESSEL_YOSAN ON BG_VESSEL_YOSAN.VESSEL_YOSAN_ID = BG_YOSAN_ITEM.VESSEL_YOSAN_ID

    INNER JOIN
    BG_YOSAN_HEAD ON BG_YOSAN_HEAD.YOSAN_HEAD_ID = BG_VESSEL_YOSAN.YOSAN_HEAD_ID

    WHERE
    BG_YOSAN_HEAD.YOSAN_HEAD_ID = :YOSAN_HEAD_ID
    AND
    BG_VESSEL_YOSAN.YEAR >= :YEAR_START
    AND
    BG_VESSEL_YOSAN.YEAR &lt;= :YEAR_END
		AND
		LENGTH(TRIM(BG_YOSAN_ITEM.NENGETSU)) = 6

		GROUP BY
		BG_YOSAN_ITEM.NENGETSU,
		BG_YOSAN_ITEM.MS_HIMOKU_ID

		ORDER BY
		BG_YOSAN_ITEM.NENGETSU,
		BG_YOSAN_ITEM.MS_HIMOKU_ID
	</sql>

  <sql name="GetRecordByYearHimokuIDMsVesselID">
    SELECT
    BG_YOSAN_ITEM.YOSAN_ITEM_ID,
    BG_YOSAN_ITEM.VESSEL_YOSAN_ID,
    BG_YOSAN_ITEM.NENGETSU,
    BG_YOSAN_ITEM.MS_HIMOKU_ID,
    BG_YOSAN_ITEM.YEN_AMOUNT,
    BG_YOSAN_ITEM.DOLLER_AMOUNT,
    BG_YOSAN_ITEM.AMOUNT,
    BG_YOSAN_ITEM.PRE_YEN_AMOUNT,
    BG_YOSAN_ITEM.PRE_DOLLER_AMOUNT,
    BG_YOSAN_ITEM.PRE_AMOUNT,
    BG_YOSAN_ITEM.BIKOU,
    BG_YOSAN_ITEM.RENEW_DATE,
    BG_YOSAN_ITEM.RENEW_USER_ID,
    BG_YOSAN_ITEM.TS
    FROM BG_YOSAN_ITEM
    LEFT OUTER JOIN BG_VESSEL_YOSAN ON BG_VESSEL_YOSAN.VESSEL_YOSAN_ID = BG_YOSAN_ITEM.VESSEL_YOSAN_ID

    WHERE

    BG_YOSAN_ITEM.NENGETSU = :NENGETSU AND
    BG_YOSAN_ITEM.MS_HIMOKU_ID = :HIMOKU_ID AND
    BG_VESSEL_YOSAN.YOSAN_HEAD_ID = :YOSAN_HEAD_ID AND
    BG_VESSEL_YOSAN.MS_VESSEL_ID = :MSVESSEL_ID
  </sql>


  <sql name="GetRecordsByYosanHeadPriodVesselTypeBumonIDHimokus">
    SELECT
    BG_YOSAN_ITEM.MS_HIMOKU_ID,
    SUM(BG_YOSAN_ITEM.YEN_AMOUNT) AS YEN_AMOUNT,
    SUM(BG_YOSAN_ITEM.DOLLER_AMOUNT) AS DOLLER_AMOUNT,
    SUM(BG_YOSAN_ITEM.AMOUNT) AS AMOUNT,
    SUM(BG_YOSAN_ITEM.PRE_YEN_AMOUNT) AS PRE_YEN_AMOUNT,
    SUM(BG_YOSAN_ITEM.PRE_DOLLER_AMOUNT) AS PRE_DOLLER_AMOUNT,
    SUM(BG_YOSAN_ITEM.PRE_AMOUNT) AS PRE_AMOUNT
    FROM BG_YOSAN_ITEM

    INNER JOIN BG_VESSEL_YOSAN ON BG_VESSEL_YOSAN.VESSEL_YOSAN_ID = BG_YOSAN_ITEM.VESSEL_YOSAN_ID
    INNER JOIN MS_VESSEL ON MS_VESSEL.MS_VESSEL_ID = BG_VESSEL_YOSAN.MS_VESSEL_ID
    INNER JOIN MS_HIMOKU ON MS_HIMOKU.MS_HIMOKU_ID = BG_YOSAN_ITEM.MS_HIMOKU_ID

    WHERE
    BG_VESSEL_YOSAN.YOSAN_HEAD_ID = :YOSAN_HEAD_ID AND
    BG_YOSAN_ITEM.NENGETSU BETWEEN :STAET_DATE AND :END_DATE AND
    MS_VESSEL.MS_VESSEL_TYPE_ID = :TYPE_ID AND
    MS_HIMOKU.MS_BUMON_ID = :BUMON_ID

    GROUP BY BG_YOSAN_ITEM.MS_HIMOKU_ID
    ORDER BY BG_YOSAN_ITEM.MS_HIMOKU_ID
  </sql>

  <sql name="GetRecordsByYosanHeadPriodVesselTypeHimokus">
    SELECT
    BG_YOSAN_ITEM.MS_HIMOKU_ID,
    SUM(BG_YOSAN_ITEM.YEN_AMOUNT) AS YEN_AMOUNT,
    SUM(BG_YOSAN_ITEM.DOLLER_AMOUNT) AS DOLLER_AMOUNT,
    SUM(BG_YOSAN_ITEM.AMOUNT) AS AMOUNT,
    SUM(BG_YOSAN_ITEM.PRE_YEN_AMOUNT) AS PRE_YEN_AMOUNT,
    SUM(BG_YOSAN_ITEM.PRE_DOLLER_AMOUNT) AS PRE_DOLLER_AMOUNT,
    SUM(BG_YOSAN_ITEM.PRE_AMOUNT) AS PRE_AMOUNT
    FROM BG_YOSAN_ITEM

    INNER JOIN BG_VESSEL_YOSAN ON BG_VESSEL_YOSAN.VESSEL_YOSAN_ID = BG_YOSAN_ITEM.VESSEL_YOSAN_ID
    INNER JOIN MS_VESSEL ON MS_VESSEL.MS_VESSEL_ID = BG_VESSEL_YOSAN.MS_VESSEL_ID
    INNER JOIN MS_HIMOKU ON MS_HIMOKU.MS_HIMOKU_ID = BG_YOSAN_ITEM.MS_HIMOKU_ID

    WHERE
    BG_VESSEL_YOSAN.YOSAN_HEAD_ID = :YOSAN_HEAD_ID AND
    BG_YOSAN_ITEM.NENGETSU BETWEEN :STAET_DATE AND :END_DATE AND
    MS_VESSEL.MS_VESSEL_TYPE_ID = :TYPE_ID

    GROUP BY BG_YOSAN_ITEM.MS_HIMOKU_ID
    ORDER BY BG_YOSAN_ITEM.MS_HIMOKU_ID
  </sql>
  
  
  
  <sql name="InsertRecord">
    INSERT INTO BG_YOSAN_ITEM
    (
    YOSAN_ITEM_ID,
    VESSEL_YOSAN_ID,
    NENGETSU,
    MS_HIMOKU_ID,
    YEN_AMOUNT,
    DOLLER_AMOUNT,
    AMOUNT,
    BIKOU,
    RENEW_DATE,
    RENEW_USER_ID,
    TS
    )
    VALUES
    (
    nextval('SEQ_BG_YOSAN_ITEM_ID'),
    :VESSEL_YOSAN_ID,
    :NENGETSU,
    :MS_HIMOKU_ID,
    :YEN_AMOUNT,
    :DOLLER_AMOUNT,
    :AMOUNT,
    :BIKOU,
    :RENEW_DATE,
    :RENEW_USER_ID,
    :TS
    )
  </sql>

	<sql name="UpdateRecord">
    UPDATE BG_YOSAN_ITEM SET

    VESSEL_YOSAN_ID = :VESSEL_YOSAN_ID,
    NENGETSU = :NENGETSU,
    MS_HIMOKU_ID = :MS_HIMOKU_ID,
    YEN_AMOUNT = :YEN_AMOUNT,
    DOLLER_AMOUNT = :DOLLER_AMOUNT,
    AMOUNT = :AMOUNT,
    BIKOU = :BIKOU,
    RENEW_DATE = :RENEW_DATE,
    RENEW_USER_ID = :RENEW_USER_ID
    WHERE
    (YOSAN_ITEM_ID = :YOSAN_ITEM_ID) AND
    (TS = :TS)
  </sql>

  <sql name="InsertRecords_新規">
    INSERT INTO BG_YOSAN_ITEM
    (
    YOSAN_ITEM_ID,
    VESSEL_YOSAN_ID,
    NENGETSU,
    MS_HIMOKU_ID,
    YEN_AMOUNT,
    DOLLER_AMOUNT,
    AMOUNT,
    RENEW_DATE,
    RENEW_USER_ID
    )
    SELECT
    nextval('SEQ_BG_YOSAN_ITEM_ID'),
    :VESSEL_YOSAN_ID,
    :NENGETSU,
    MS_HIMOKU_ID,
    0,
    0,
    0,
    :RENEW_DATE,
    :RENEW_USER_ID

    FROM MS_HIMOKU
  </sql>

  <sql name="InsertRecords_コピー">
    INSERT INTO BG_YOSAN_ITEM
    (
    YOSAN_ITEM_ID,
    VESSEL_YOSAN_ID,
    NENGETSU,
    MS_HIMOKU_ID,
    YEN_AMOUNT,
    DOLLER_AMOUNT,
    AMOUNT,
    PRE_YEN_AMOUNT,
    PRE_DOLLER_AMOUNT,
    PRE_AMOUNT,
    RENEW_DATE,
    RENEW_USER_ID
    )

    SELECT
    nextval('SEQ_BG_YOSAN_ITEM_ID'),
    :VESSEL_YOSAN_ID,
    NENGETSU,
    MS_HIMOKU_ID,
    YEN_AMOUNT,
    DOLLER_AMOUNT,
    AMOUNT,
    YEN_AMOUNT AS PRE_YEN_AMOUNT,
    DOLLER_AMOUNT AS PRE_DOLLER_AMOUNT,
    AMOUNT AS PRE_AMOUNT,
    :RENEW_DATE,
    :RENEW_USER_ID

    FROM
    BG_YOSAN_ITEM

    JOIN
    BG_VESSEL_YOSAN
    ON BG_VESSEL_YOSAN.VESSEL_YOSAN_ID = BG_YOSAN_ITEM.VESSEL_YOSAN_ID
    JOIN
    BG_YOSAN_HEAD
    ON BG_YOSAN_HEAD.YOSAN_HEAD_ID = BG_VESSEL_YOSAN.YOSAN_HEAD_ID

    WHERE
    BG_YOSAN_HEAD.YOSAN_HEAD_ID = :LAST_YOSAN_HEAD_ID
    AND
    BG_VESSEL_YOSAN.MS_VESSEL_ID = :MS_VESSEL_ID
    AND
    BG_VESSEL_YOSAN.YEAR = :VESSEL_YOSAN_YEAR
  </sql>

  <sql name="ExistsLastRecords">
    SELECT
    COUNT(*)

    FROM
    BG_YOSAN_ITEM

    JOIN
    BG_VESSEL_YOSAN
    ON BG_VESSEL_YOSAN.VESSEL_YOSAN_ID = BG_YOSAN_ITEM.VESSEL_YOSAN_ID
    JOIN
    BG_YOSAN_HEAD
    ON BG_YOSAN_HEAD.YOSAN_HEAD_ID = BG_VESSEL_YOSAN.YOSAN_HEAD_ID

    WHERE
    BG_YOSAN_HEAD.YOSAN_HEAD_ID = :LAST_YOSAN_HEAD_ID
    AND
    BG_VESSEL_YOSAN.MS_VESSEL_ID = :MS_VESSEL_ID
    AND
    BG_VESSEL_YOSAN.YEAR = :VESSEL_YOSAN_YEAR
  </sql>

</databaseConfig>

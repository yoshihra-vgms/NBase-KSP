<?xml version="1.0" encoding="utf-8" ?>

<databaseConfig>

  <sql name="GetRecords">
    SELECT

    OD_JRY.OD_JRY_ID
    ,OD_JRY.STATUS
    ,OD_JRY.JRY_DATE
    ,OD_JRY.AMOUNT
    ,OD_JRY.NEBIKI_AMOUNT
    ,OD_JRY.TAX
    ,OD_THI.NAIYOU as OD_THI_NAIYOU
    ,OD_MK.HACHU_DATE as MS_HACHU_DATE
    ,OD_MK.HACHU_NO as MS_HACHU_NO
    ,MS_CUSTOMER.CUSTOMER_NAME as MS_CUSTOMER_NAME
    ,OD_JRY.KAMOKU_NO
    ,OD_JRY.UTIWAKE_KAMOKU_NO
    ,OD_JRY.CARRIAGE

    FROM
    OD_JRY

    INNER JOIN OD_MK ON OD_JRY.OD_MK_ID = OD_MK.OD_MK_ID
    AND OD_MK.CANCEL_FLAG = 0
    AND OD_MK.MS_CUSTOMER_ID = :MS_CUSTOMER_ID
    INNER JOIN MS_CUSTOMER ON OD_MK.MS_CUSTOMER_ID = MS_CUSTOMER.MS_CUSTOMER_ID
    INNER JOIN OD_MM ON OD_MK.OD_MM_ID = OD_MM.OD_MM_ID
    AND OD_MM.CANCEL_FLAG = 0
    INNER JOIN OD_THI ON OD_MM.OD_THI_ID = OD_THI.OD_THI_ID
    AND OD_THI.CANCEL_FLAG = 0
    AND OD_THI.MS_THI_IRAI_SBT_ID = :MS_THI_IRAI_SBT_ID
    AND OD_THI.MS_VESSEL_ID = :MS_VESSEL_ID

    WHERE OD_JRY.CANCEL_FLAG = 0
    AND OD_JRY.STATUS = :JRY_STATUS
    AND NOT EXISTS (SELECT OD_SHR_ID FROM OD_SHR WHERE OD_SHR.CANCEL_FLAG = 0 AND OD_SHR.OD_JRY_ID = OD_JRY.OD_JRY_ID)
    AND NOT EXISTS (SELECT OD_JRY_ID FROM OD_SHR_GASSAN_ITEM WHERE OD_SHR_GASSAN_ITEM.OD_JRY_ID = OD_JRY.OD_JRY_ID)
  </sql>
  <sql name="OrderBy">
    ORDER BY OD_JRY.JRY_DATE, OD_MK.HACHU_DATE, OD_MK.HACHU_NO
  </sql>

  <sql name="FilterByThiIraiShousaiID">
    AND OD_THI.MS_THI_IRAI_SHOUSAI_ID = :MS_THI_IRAI_SHOUSAI_ID
  </sql>
  <sql name="FilterByJryDateFrom">
    AND TO_CHAR(OD_JRY.JRY_DATE,'YYYY/MM/DD') >= TO_CHAR(:JRY_DATE_FROM,'YYYY/MM/DD')
  </sql>
  <sql name="FilterByJryDateTo">
    AND TO_CHAR(OD_JRY.JRY_DATE,'YYYY/MM/DD') &lt;= TO_CHAR(:JRY_DATE_TO,'YYYY/MM/DD')
  </sql>
  <sql name="FilterByJryDateFromTo">
    AND TO_CHAR(OD_JRY.JRY_DATE,'YYYY/MM/DD') >= TO_CHAR(:JRY_DATE_FROM,'YYYY/MM/DD')
    AND TO_CHAR(OD_JRY.JRY_DATE,'YYYY/MM/DD') &lt;= TO_CHAR(:JRY_DATE_TO,'YYYY/MM/DD')
  </sql>

</databaseConfig>

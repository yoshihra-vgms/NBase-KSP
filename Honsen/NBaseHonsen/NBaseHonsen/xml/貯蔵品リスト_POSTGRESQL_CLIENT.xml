<?xml version="1.0" encoding="utf-8" ?>

<databaseConfig>

  <sql name="GetRecords発注潤滑油">
    SELECT
    a.MS_VESSEL_ID,
    h.MS_LO_ID as "ID",
    i.LO_NAME as "品名",
    c.HACHU_NO as "発注番号",
    f.CUSTOMER_NAME as "業者名",
    d.JRY_DATE as "納品日",
    h.JRY_COUNT as "受領数",
    h.TANKA as "受領単価",
    l.COUNT as "支払数",
    l.TANKA as "支払単価",
    j.TANI_NAME as "単位",
    to_char(d.JRY_DATE, 'yyyymm') as "受領年月"
    ,h.OD_JRY_SHOUSAI_ITEM_ID as "JS_ID"
    ,l.OD_SHR_SHOUSAI_ITEM_ID as "SS_ID"

    FROM
    OD_THI a
    INNER JOIN OD_MM b ON b.OD_THI_ID = a.OD_THI_ID AND b.CANCEL_FLAG = 0
    INNER JOIN OD_MK c ON c.OD_MM_ID = b.OD_MM_ID AND c.CANCEL_FLAG = 0
    INNER JOIN OD_JRY d ON d.OD_MK_ID = c.OD_MK_ID AND d.CANCEL_FLAG = 0
    INNER JOIN OD_JRY_ITEM g ON g.OD_JRY_ID = d.OD_JRY_ID AND d.CANCEL_FLAG = 0
    INNER JOIN OD_JRY_SHOUSAI_ITEM h ON h.OD_JRY_ITEM_ID = g.OD_JRY_ITEM_ID AND h.CANCEL_FLAG = 0

    INNER JOIN MS_LO i ON h.MS_LO_ID = i.MS_LO_ID
    INNER JOIN MS_CUSTOMER f ON c.MS_CUSTOMER_ID = f.MS_CUSTOMER_ID
    LEFT JOIN MS_TANI j ON h.MS_TANI_ID = j.MS_TANI_ID

    LEFT JOIN (OD_SHR e INNER JOIN (OD_SHR_ITEM k  INNER JOIN OD_SHR_SHOUSAI_ITEM l ON l.OD_SHR_ITEM_ID = k.OD_SHR_ITEM_ID AND l.CANCEL_FLAG = 0)
    ON k.OD_SHR_ID = e.OD_SHR_ID AND k.CANCEL_FLAG = 0)
    ON e.OD_JRY_ID = d.OD_JRY_ID AND e.CANCEL_FLAG = 0 AND e.SBT = 0 AND e.STATUS = :SHR_STATUS
    AND l.MS_LO_ID = h.MS_LO_ID

    WHERE
    a.CANCEL_FLAG = 0
    AND a.MS_THI_IRAI_SBT_ID = :MS_THI_IRAI_SBT_ID
    AND a.MS_VESSEL_ID = :MS_VESSEL_ID
    AND to_char(d.JRY_DATE, 'yyyymm') = :YYYYMM
    AND h.MS_LO_ID = :MS_LO_ID
    AND (h.JRY_COUNT > 0 OR l.COUNT > 0)

    ORDER BY d.JRY_DATE DESC, c.HACHU_NO DESC
  </sql>


  <sql name="GetRecords発注船用品">
    SELECT
    a.MS_VESSEL_ID,
    h.MS_VESSEL_ITEM_ID as "ID",
    i.VESSEL_ITEM_NAME as "品名",
    c.HACHU_NO as "発注番号",
    f.CUSTOMER_NAME as "業者名",
    d.JRY_DATE as "納品日",
    h.JRY_COUNT as "受領数",
    h.TANKA as "受領単価",
    l.COUNT as "支払数",
    l.TANKA as "支払単価",
    j.TANI_NAME as "単位",
    to_char(d.JRY_DATE, 'yyyymm') as "受領年月"
    ,h.OD_JRY_SHOUSAI_ITEM_ID as "JS_ID"
    ,l.OD_SHR_SHOUSAI_ITEM_ID as "SS_ID"

    FROM
    OD_THI a
    INNER JOIN OD_MM b ON b.OD_THI_ID = a.OD_THI_ID AND b.CANCEL_FLAG = 0
    INNER JOIN OD_MK c ON c.OD_MM_ID = b.OD_MM_ID AND c.CANCEL_FLAG = 0
    INNER JOIN OD_JRY d ON d.OD_MK_ID = c.OD_MK_ID AND d.CANCEL_FLAG = 0
    INNER JOIN OD_JRY_ITEM g ON g.OD_JRY_ID = d.OD_JRY_ID AND d.CANCEL_FLAG = 0
    INNER JOIN OD_JRY_SHOUSAI_ITEM h ON h.OD_JRY_ITEM_ID = g.OD_JRY_ITEM_ID AND h.CANCEL_FLAG = 0

    INNER JOIN MS_VESSEL_ITEM i ON h.MS_VESSEL_ITEM_ID = i.MS_VESSEL_ITEM_ID AND i.CATEGORY_NUMBER = :CATEGORY_NUMBER
    INNER JOIN MS_CUSTOMER f ON c.MS_CUSTOMER_ID = f.MS_CUSTOMER_ID
    LEFT JOIN MS_TANI j ON h.MS_TANI_ID = j.MS_TANI_ID

    LEFT JOIN (OD_SHR e INNER JOIN (OD_SHR_ITEM k  INNER JOIN OD_SHR_SHOUSAI_ITEM l ON l.OD_SHR_ITEM_ID = k.OD_SHR_ITEM_ID AND l.CANCEL_FLAG = 0)
    ON k.OD_SHR_ID = e.OD_SHR_ID AND k.CANCEL_FLAG = 0)
    ON e.OD_JRY_ID = d.OD_JRY_ID AND e.CANCEL_FLAG = 0 AND e.SBT = 0 AND e.STATUS = :SHR_STATUS
    AND l.MS_VESSEL_ITEM_ID = h.MS_VESSEL_ITEM_ID
    AND l.BIKOU = h.BIKOU

    WHERE
    a.CANCEL_FLAG = 0
    AND a.MS_THI_IRAI_SBT_ID = :MS_THI_IRAI_SBT_ID
    AND a.MS_VESSEL_ID = :MS_VESSEL_ID
    AND to_char(d.JRY_DATE, 'yyyymm') = :YYYYMM
    AND h.MS_VESSEL_ITEM_ID = :MS_VESSEL_ITEM_ID
    AND (h.JRY_COUNT > 0 OR l.COUNT > 0)

    ORDER BY d.JRY_DATE DESC, c.HACHU_NO DESC
  </sql>

  <sql name="GetRecords発注特定品">
    SELECT
    a.MS_VESSEL_ID,
    h.MS_VESSEL_ITEM_ID as "ID",
    i.VESSEL_ITEM_NAME as "品名",
    c.HACHU_NO as "発注番号",
    f.CUSTOMER_NAME as "業者名",
    d.JRY_DATE as "納品日",
    h.JRY_COUNT as "受領数",
    h.TANKA as "受領単価",
    l.COUNT as "支払数",
    l.TANKA as "支払単価",
    j.TANI_NAME as "単位",
    to_char(d.JRY_DATE, 'yyyymm') as "受領年月"
    ,h.OD_JRY_SHOUSAI_ITEM_ID as "JS_ID"
    ,l.OD_SHR_SHOUSAI_ITEM_ID as "SS_ID"

    FROM
    OD_THI a
    INNER JOIN OD_MM b ON b.OD_THI_ID = a.OD_THI_ID AND b.CANCEL_FLAG = 0
    INNER JOIN OD_MK c ON c.OD_MM_ID = b.OD_MM_ID AND c.CANCEL_FLAG = 0
    INNER JOIN OD_JRY d ON d.OD_MK_ID = c.OD_MK_ID AND d.CANCEL_FLAG = 0
    INNER JOIN OD_JRY_ITEM g ON g.OD_JRY_ID = d.OD_JRY_ID AND d.CANCEL_FLAG = 0
    INNER JOIN OD_JRY_SHOUSAI_ITEM h ON h.OD_JRY_ITEM_ID = g.OD_JRY_ITEM_ID AND h.CANCEL_FLAG = 0

    INNER JOIN MS_VESSEL_ITEM i ON h.MS_VESSEL_ITEM_ID = i.MS_VESSEL_ITEM_ID AND i.CATEGORY_NUMBER != :CATEGORY_NUMBER
    INNER JOIN MS_VESSEL_ITEM_VESSEL m ON h.MS_VESSEL_ITEM_ID = m.MS_VESSEL_ITEM_ID AND m.SPECIFIC_FLAG = 1 AND m.MS_VESSEL_ID = :MS_VESSEL_ID
    INNER JOIN MS_CUSTOMER f ON c.MS_CUSTOMER_ID = f.MS_CUSTOMER_ID
    LEFT JOIN MS_TANI j ON h.MS_TANI_ID = j.MS_TANI_ID

    LEFT JOIN (OD_SHR e INNER JOIN (OD_SHR_ITEM k  INNER JOIN OD_SHR_SHOUSAI_ITEM l ON l.OD_SHR_ITEM_ID = k.OD_SHR_ITEM_ID AND l.CANCEL_FLAG = 0)
    ON k.OD_SHR_ID = e.OD_SHR_ID AND k.CANCEL_FLAG = 0)
    ON e.OD_JRY_ID = d.OD_JRY_ID AND e.CANCEL_FLAG = 0 AND e.SBT = 0 AND e.STATUS = :SHR_STATUS
    AND l.MS_VESSEL_ITEM_ID = h.MS_VESSEL_ITEM_ID
    AND l.BIKOU = h.BIKOU

    WHERE
    a.CANCEL_FLAG = 0
    AND a.MS_THI_IRAI_SBT_ID = :MS_THI_IRAI_SBT_ID
    AND a.MS_VESSEL_ID = :MS_VESSEL_ID
    AND to_char(d.JRY_DATE, 'yyyymm') = :YYYYMM
    AND h.MS_VESSEL_ITEM_ID = :MS_VESSEL_ITEM_ID
    AND (h.JRY_COUNT > 0 OR l.COUNT > 0)

    ORDER BY d.JRY_DATE DESC, c.HACHU_NO DESC
  </sql>

</databaseConfig>
